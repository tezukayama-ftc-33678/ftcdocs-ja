Blocks での Op Mode 管理 :bdg-warning:`Blocks`
================================================

**Blocks** は、グラフィカルなプログラミング要素を使用してプログラムを作成するプログラミング言語です。そのため、そのファイルフォーマットは、JAVAや他のテキストベースのプログラミング言語ファイルとは異なります。**Blocks** プログラムは **.blk** 拡張子で保存されますが、その内容は実際にはXML（Extensible Markup Language）としてフォーマットされています。**Blocks** プログラムの実際のXMLフォーマットは、このドキュメントの範囲を超えていますが、**Blocks** 以外のプログラムで読み取り/表示/解釈されることを意図していないことだけは言っておきます。MACやPCで **Blocks** プログラムを表示または編集できる一般的なプログラムは存在せず、常に **Robot Controller** アプリ（**REV Control Hub** または認可されたAndroid スマートフォン上で実行される）内の **Blocks** インターフェースを通じて行う必要があります。つまり、ファイルをダブルクリックして、コンピューター上のエディタープログラムで開くことはできません。

Op Mode の作成
------------------

:doc:`Op Mode 作成のための優れたチュートリアル
<../creating_op_modes/Writing-an-Op-Mode-with-FTC-Blocks>` があり、**Blocks** インターフェースについて多くのことを説明し、**Blocks** プログラムが何をするのかを理解するのに役立ちます。**Blocks** の **Op Mode** の使い方を学ぶために、このドキュメントを確認することをお勧めします。 

Op Mode の保存
----------------

**Op Mode** の **「保存」** が何を意味するかを理解することが重要です。**Op Mode** をプログラミング/編集する際、Webブラウザ（Chromeなど）を使用するか、Webブラウザとして *動作する* プログラム（REV Hardware Clientなど）を使用します。作成/編集しているプログラムは、Webブラウザ内に *一時的に* のみ存在します。自動保存機能や、プログラムが最終的にデバイス（**REV Control Hub** または承認されたスマートフォン）に保存されることを保証する機能はありません。*保存* 操作のみが、実際に **Op Mode** を **.blk** ファイルとしてデバイスに保存します。したがって、**Blocks** プログラマーは頻繁に作業を *保存* し、特に作業が完了したら必ず保存することが不可欠です。**Op Mode** を *保存* するメカニズムは、ソフトウェアの編集ウィンドウ内の「**Save Op Mode**」ボタンを使用します。

.. figure:: images/blocks_save.jpg
   :align: center
   :width: 80%
   :alt: Saving Opmode

   Blocks エディター内での Op Mode の保存

プログラムが保存されると、プログラムが保存されたことを示すメッセージが同じ行の右側に表示されます。

.. figure:: images/blocks_saved.jpg
   :align: center
   :width: 80%
   :alt: Opmode Saved

   Op Mode が保存されたことを示すメッセージ

Op Mode のダウンロード
~~~~~~~~~~~~~~~~~~~~~~~~

**Op Mode** がデバイスに保存されると、**DRIVER STATION** を介して **Op Mode** を選択したり、プログラミングインターフェースを介して再度編集したりできます。ただし、その **Blocks** プログラムは、デバイス上の **Blocks** ファイル（**.blk**）としてのみ存在します。多くの場合、ラップトップ（または別のデバイス、または他の安全な場所）にプログラムのコピーを保存したり、他の人（チームメート、別のロボット、他のチーム、オンラインで提供するなど）が使用できるようにプログラムを提供したりすることが望ましいです。

デバイスから **Blocks** プログラムのコピーを取得するには、デバイスからプログラムを *ダウンロード* する必要があります。これは、編集インターフェースまたはメインの **Blocks** 管理インターフェースのいずれかを使用して、2つの方法のいずれかで実行できます。

編集インターフェースを通じた Op Mode のダウンロード
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

**Op Mode** を編集している間、**Op Mode** は *保存* でき、また *ダウンロード* もできます（他のオプションもありますが、今のところこの2つに焦点を当てます）。**Op Mode** が保存されると、プログラムは **Blocks** ファイル（**.blk**）として **デバイス上に** 保存されます。プログラムのコピーをローカルコンピューター（安全な保管または共有のため）に保存するには、プログラムを *ダウンロード* する必要があります。プログラムをダウンロードすると、現在のプログラムに対して保存アクションが *実行されます* が、これに依存すべきではありません。プログラマーは常にダウンロードする前にプログラムを保存する必要があります。**Op Mode** のダウンロードは、編集インターフェース内の「**Download Op Mode**」ボタンを介して実行されます。

.. figure:: images/blocks_download.jpg
   :align: center
   :width: 80%
   :alt: Opmode Download

   Blocks プログラムのダウンロード

「Download Op Mode」ボタンを押すと、ファイルがWebブラウザで利用可能になり、Webブラウザは通常の方法でファイルを管理します（たとえば、Chromeではファイルがコンピューターの「Downloads」フォルダーに保存されます）。

管理インターフェースを通じた Op Mode のダウンロード
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

「Blocks」メニュー項目をクリックすると、**Blocks** 管理インターフェースに移動します。このインターフェースには、現在デバイス上にあるすべての **Blocks** の **Op Mode** が表示され、それらの **Op Mode** を管理するためのオプションが提供されます。

.. figure:: images/blocks_manage.png
   :align: center
   :width: 80%
   :alt: Blocks Management

   Blocks 管理インターフェース

**Op Mode** はこのインターフェースを通じてダウンロードできます。最初、このインターフェースの「**Download Selected Op Modes**」ボタンはグレーアウトされています。このインターフェースで1つ以上の **Op Mode** を選択し、それらをすべて一度にダウンロードできます。以下の例では、「Mecanum Drive」**Op Mode** が選択され、「**Download Selected Op Modes**」ボタンを介してダウンロードされます。

.. figure:: images/blocks_manage_download.png
   :align: center
   :width: 80%
   :alt: Blocks Management Download

   管理インターフェースを介した Blocks のダウンロード

Blocks のアップロード
----------------

以前にダウンロードした **Blocks** ファイルがある場合、または他のソース（たとえば、REVからのサンプル **Blocks** など）から **Blocks** ファイルを受け取った場合、**Blocks** ファイル（**.blk**）をデバイス（**REV Control Hub** またはAndroid スマートフォン）に *アップロード* する必要があります。**Blocks** 管理インターフェース内には、「**Upload Op Mode**」とマークされたトップメニューのボタンがあります。

「**Upload Op Mode**」を押すと、アップロードするファイルを選択できるポップアップウィンドウが表示されます。「**Choose File**」ボタンをクリックして、ローカルコンピューターのファイルブラウザを開き、アップロードする **.blk** **Blocks** ファイルを選択します。アップロードされると、**Blocks** プログラムは **Blocks** インターフェース内で開きます。

.. figure:: images/blocks_manage_upload.png
   :align: center
   :width: 80%
   :alt: Blocks Management File Upload

   管理インターフェースを介した Blocks ファイルのアップロード

ブロックがアップロードされると、他の **Op Mode** と同じように編集および変更できます！


